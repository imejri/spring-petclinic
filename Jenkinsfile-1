/* Pipeline de Build de notre application petclinic */

pipeline {

    agent any  // Build sur le contr√¥leur
    options {
        timeout(time: 1, unit: 'HOURS')
    }
    stages {

        stage ('checkout code') {
            steps {
                checkout scmGit(branches: 
                [[name: '*/pipeline-1']], userRemoteConfigs: 
                [[url: 'https://github.com/imejri/spring-petclinic.git']])
            }
        } // stage

        stage('Compilation du code') {
            agent {
                docker { image 'maven:3.8.4-openjdk-8' }
            }

            steps {
                script {
                    sh 'mvn package -DskipTests'
                }
            }
        } // stage
    } //stages
    post {
        success {
            echo 'Build application successfull'  
        }
    } //post action
} // pipeline